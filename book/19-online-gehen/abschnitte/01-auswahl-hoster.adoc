=== Die Auswahl des richtiges Hosters

Durch die Auswahl eines Hosters, dessen Serversysteme auf die
Bedürfnisse von Joomla! angepasst sind, lassen sich viele Probleme, die
im späteren Alltag stören, von vornherein vermeiden. Daher möchte ich,
bevor ich den eigentlichen Migrationsvorgang beschreibe, noch auf die
Wahl des richtigen Webhosters eingehen. Grundvoraussetzung ist dabei
selbstverständlich, dass die Serverkonfiguration den
Empfehlungenfootnote:[[.underline]#http://www.joomla.org/technical-requirements.html#]
für die jeweilige Joomla!-Version entspricht. Im Falle von Joomla! 3.7
benötigen wir hier:

[width="100%",cols="59%,20%,21%",]
|===
|Software |Empfohlen |Minimum

|PHP (mit Unterstützung für zlib, xml und mysqli) |7.0{plus}
|5.3.10{plus}

|MySQL |5.5.3 {plus} |5.1

|Apache |2.4 {plus} |2.0

|Microsoft IIS |7 |7

|Nginx |1.8{plus} |1.0
|===

Selbstverständlich reicht es, wenn der entsprechende Hoster dabei einen
der drei angegebenen Webserver (Apache, IIS, Nginx) unterstützt.

Zudem ist es wünschenswert, dass die Konfiguration von PHP den Vorgaben
entspricht:

* register++_++globals = off
* magic++_++quotes++_++gpc = off
* safe++_++mode = off
* memory++_++limit größer als 128MB
* max++_++execution++_++time größer als 90 Sekunden

Bei der Datenbankanbindung sollte zudem darauf geachtet werden, dass die
Datenbank auf demselben Server wie der Webserver liegt (localhost), da
ansonsten zusätzliche Verzögerungen durch die Netzwerklatenz auftreten
können. Am besten prüfen Sie dies mit einem kostenlosen Testaccount, den
Ihnen nahezu jeder seriöse Hoster zur Verfügung stellen wird.

Doch selbst wenn diese Voraussetzungen erfüllt sind, gibt es häufig
Probleme im Zusammenhang mit den Datei- und Verzeichnisrechten, die mit
dem sog. „www-run“-Problem zusammenhängen.

==== Das wwwrun-Problem

Das „www-run“-Problem entsteht aus der Kombination der
Webserverkonfiguration bei vielen Hostern und den Grundprinzipien von
UNIX-Dateisystemen. UNIX-Systeme bieten nämlich die Möglichkeit, für
jede Datei und jeden Ordner separat festzulegen, welche Rechte der
Benutzer hat, der gerade Zugriff nehmen möchte.

Das System unterscheidet dabei zwischen drei Zugriffsarten: dem
Lesezugriff, dem Schreibzugriff und dem Ausführen (bei Dateien) bzw. dem
Einsehen des Inhalts (bei Ordnern). Für jede Aktion kann festgelegt
werden, ob diese vom Eigentümer selbst, von den Mitgliedern der
zugeordneten Gruppe oder „allen anderen“ ausgeführt werden kann. Somit
entsteht das folgende Raster, das in unserem Beispiel allen Benutzern
Lese-, jedoch nur dem Eigentümer Schreibzugriff erlauben würde.

[width="100%",cols="51%,17%,14%,18%",]
|===
| |Eigentümer |Gruppe |Alle anderen
|Lesen |Ja |Ja |Ja
|Schreiben |Ja |Nein |Nein
|Ausführen (Dateien) bzw. Einsehen (Ordner) |Nein |Nein |Nein
|===

Da dieses Raster im Normalfall aber zu umfangreich wäre, um es
ausführlich auszugeben, hat sich eine Kurzschreibweise eingebürgert, bei
der jeder Aktion eine Zahl zugeordnet wird.

[width="100%",cols="50%,50%",]
|===
|Aktion |Zahl
|Lesen |4
|Schreiben |2
|Ausführen |1
|===

Ist eine Aktion nicht erlaubt, erhält sie den Zahlenwert 0. Wir
übertragen dieses System nun auf unser Raster und addieren die
Zahlenwerte der jeweiligen Spalten.

[width="100%",cols="34%,22%,22%,22%",]
|===
| |Eigentümer |Gruppe |Alle anderen
|Lesen |Ja = 4 |Ja = 4 |Ja = 4
|Schreiben |Ja = 2 |Nein = 0 |Nein = 0
|Ausführen/Einsehen |Nein = 0 |Nein = 0 |Nein = 0
|Summe |6 |4 |4
|===

Nach dem Addieren erhalten wir die Zahl 644, die als Entsprechung für
unser Rechtemuster fungiert. Soll jede Aktion für jeden Benutzer erlaubt
sein, so muss die entsprechende Datei folglich mit den Rechten „777“
ausgestattet sein.

[width="100%",cols="34%,22%,22%,22%",]
|===
| |Eigentümer |Gruppe |Alle anderen
|Lesen |Ja = 4 |Ja = 4 |Ja = 4
|Schreiben |Ja = 2 |Ja = 2 |Ja = 2
|Ausführen/Einsehen |Ja = 1 |Ja = 1 |Ja = 1
|Summe |7 |7 |7
|===

Haben Sie das Prinzip verstanden? Wunderbar! Dann kommen wir nun zur
gängigen Konfiguration von Webservern bei großen Hostern. Dort wird in
der Regel der Webserver Apache eingesetzt, der verschiedene
Möglichkeiten zur Anbindung von PHP bietet. Die performanteste Variante
ist dabei die Verwendung des Apache-Moduls _mod++_++php_, das sich
nahtlos in den Webserver integriert und durch die hohe Geschwindigkeit
große Mengen an Kunden auf einem System zulässt. Der Apache läuft dabei
im System unter einem eigenen Benutzernamen, der auf vielen Systemen
standardmäßig „www-run“ lautet, und „vererbt“ diesen Benutzernamen auch
automatisch an alle PHP-Programme, da diese mittels _mod++_++php_ direkt
im Webserver gestartet werden. Der FTP-Server, den wir nutzen, um unsere
Dateien hochzuladen, ordnet im Unterschied dazu jedem Kunden einen
individuellen Benutzernamen zu, wodurch das folgende Konstrukt entsteht.

image:book/19-online-gehen/media/1.png[C:++\++Users++\++hwunder++\++Desktop++\++rtf++\++19++\++Bild607.PNG,width=318,height=252]

BILD 19.1 Abbildung der Rechtestruktur bei Verwendung von PHP als
mod++_++php

Was passiert, wenn wir nun eine Datei per FTP hochladen? Diese wird vom
Benutzer „ftp-1“ erstellt, der dadurch automatisch Eigentümer wird.
Standardmäßig ist es jetzt allen anderen Benutzern, und dadurch auch
unserem „www-run“, nicht mehr möglich, die per FTP hochgeladenen Dateien
zu beschreiben. Dieser Umstand ist problematisch, da wir keinerlei
Änderungen an den Dateien unserer Joomla!-Installation über den Browser
vornehmen können, weil dafür der Schreibzugriff durch PHP möglich sein
muss. Somit bekommen wir z. B. bei der Erweiterungsinstallation, beim
Aktivieren des Caching-Mechanismus oder beim Upload eines einfachen
Bilds die Meldung, dass wir nicht über die nötigen Rechte verfügen.

Welche Möglichkeiten haben wir, dieses Dilemma zu umgehen?

* Wir erlauben allen Benutzern, alle gewünschten Aktionen auf unsere
Dateien auszuführen, was durch den UNIX-Befehl „chmod 777“ bzw. durch
unser FTP-Tool erledigt werden könnte. Dadurch öffnen wir aber auch
Angreifern Tür und Tor, da diese nun alle hinterlegten Dateien unserer
Installation verändern können. Zudem müssten wir diesen Befehl nach
jedem Hinzufügen einer Datei erneut ausführen – das scheint also kein
praktikabler Weg zu sein.
* Wir ändern den Eigentümer unserer Installation auf „www-run“, sodass
wir über den Browser nun alle Dateien und Ordner anpassen können. Das
kehrt das Problem jedoch nur um, da keine Änderungen per FTP mehr
möglich sind.
* Wir nutzen den in Joomla! integrierten „FTP-Modus“, der sich beim
Dateizugriff über das FTP-Protokoll mit dem Server verbindet und dadurch
mit den Rechten des FTP-Benutzers schreiben kann. Diese Variante erlaubt
uns Schreibzugriff in allen Situationen, ist jedoch sehr langsam.

Es lässt sich also feststellen, dass wir bei der Einbindung von PHP als
_mod++_++php_ keine Möglichkeit haben, unsere Dateien bequem bearbeiten
zu können. Deshalb kommen Hoster, die auf diese Konfiguration setzen,
für den sinnvollen Einsatz von Joomla! (bzw. allen Arten von
serverseitigen Skripten) nicht infrage. Ob unser Server von diesem
Problem betroffen ist, verrät uns der folgende Eintrag in den
PHP-Informationen, die im Joomla! Backend unter _Site ++>++
Systeminformationen_ angezeigt werden können.

image:book/19-online-gehen/media/3.png[book/19-online-gehen/media/3,width=548,height=226]

BILD 19.2 Einbindung von PHP über den Apache 2.0 Handler von mod++_++php

Glücklicherweise gibt es eine alternative Einbindungsart für PHP,
nämlich die Nutzung des FastCGI- oder FPM-Standards, der es erlaubt,
eine PHP-Instanz mit den Rechten eines anderen Benutzers (wie den
FTP-Account einer Domain) ausführen zu lassen. Dabei sind wir nicht auf
die Angabe eines einzelnen Benutzers festgelegt, sondern können z. B.
für jeden Kunden eine individuelle FastCGI-Version von PHP erstellen, um
diese dem jeweiligen FTP-Benutzer zuordnen zu können, was auf
Mehrbenutzersystemen erforderlich ist.

image:book/19-online-gehen/media/4.png[C:++\++Users++\++hwunder++\++Desktop++\++rtf++\++19++\++Bild623.PNG,width=314,height=252]

BILD 19.3 Rechtestruktur bei der Einbindung von PHP als FastCGI

Der einzige Nachteil der Einbindung über FastCGI/FPM ist der größere
Speicherbedarf, der dazu führt, dass man als Hoster, im Vergleich zur
„klassischen“ Konfiguration mittels _mod++_++php_, weniger Kunden auf
einem Server hosten kann. Das lässt die Kosten pro Kunde ansteigen und
ist somit der Grund dafür, dass es noch immer Hoster mit dieser
Konfiguration gibt.

Die Tatsache, dass wir durch die Einbindung als FastCGI/FPM jedoch nun
eine sichere und komfortable Möglichkeit zur Verwaltung unserer Dateien
mittels PHP und FTP haben, die keine Modifikation der Verzeichnisrechte
erfordert, lässt diese Einbindungsart definitiv zur Anbindung der Wahl
werden.

Woran erkennt man nun also die korrekte Einbindung bei der Hoster-Suche?
Auch hier hilft wieder ein Blick in die Ausgabe der PHP-Informationen.

image:book/19-online-gehen/media/5.png[book/19-online-gehen/media/5,width=548,height=219]

BILD 19.4 PHP-Informationen bei der Nutzung des FPM-Standards

Ist auch diese technische Voraussetzung erfüllt, so spricht dem
Vertragsabschluss beim jeweiligen Hoster zumindest technisch nichts mehr
entgegen.

[width="99%",cols="14%,86%",options="header",]
|===
|CHV++_++BOX++_++ID++_++01 |
|icn001 a|
Es gibt inzwischen eine große Menge Hoster, die zwar die notwendigen
technischen Mindestvoraussetzungen erfüllen, aber in Sachen Performance,
Service oder Sicherheit nicht für professionelles Arbeiten geeignet
sind. Anstelle einer Negativliste möchte ich Ihnen lieber eine Liste mit
Hostern an die Hand geben, die aktiv die deutsche Joomla-Community und
die Weiterentwicklung des Projekts unterstützen und sich somit aktiv
einbringen:

* Hosting.de
* Mittwald
* Siteground
* Deevop
* 1&1

|===

[width="99%",cols="14%,86%",options="header",]
|===
|CHV++_++BOX++_++ID++_++01 |
|icn001 |*Praxistipp:* Sollte ein einfacher Webspace für die eigenen
Bedürfnisse nicht ausreichen, sodass ein Root-Server gemietet werden
muss, so ist darauf zu achten, dass das verwendete Control-Panel die
Einbindung als FastCGI unterstützt. Derzeit kommen da die z.B. aktuellen
Versionen von Plesk, Froxlor und LiveConfig in Frage.
|===
